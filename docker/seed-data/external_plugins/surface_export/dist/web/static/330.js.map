{"version":3,"file":"static/330.js","mappings":"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","sources":["webpack://@solarcloud7/plugin-surface-export/./web/style.css","webpack://@solarcloud7/plugin-surface-export/./web/style.css?93f3","webpack://@solarcloud7/plugin-surface-export/./web/index.jsx"],"sourcesContent":["// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.surface-export-tab-body {\r\n\tdisplay: grid;\r\n\tgrid-template-columns: 1fr;\r\n\tgap: 16px;\r\n}\r\n\r\n@media (min-width: 1200px) {\r\n\t.surface-export-tab-body {\r\n\t\tgrid-template-columns: 1.2fr 0.8fr;\r\n\t\talign-items: start;\r\n\t}\r\n}\r\n\r\n.surface-export-tree-panel,\r\n.surface-export-action-panel {\r\n\tmin-width: 0;\r\n}\r\n\r\n.surface-export-log-body {\r\n\tdisplay: grid;\r\n\tgrid-template-columns: 1fr;\r\n\tgap: 16px;\r\n}\r\n\r\n.surface-export-log-row {\r\n\tcursor: pointer;\r\n}\r\n\r\n.surface-export-log-row-selected > td {\r\n\tbackground: rgba(24, 144, 255, 0.12) !important;\r\n}\r\n`, \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\n      import API from \"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[3].use[1]!./style.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[3].use[1]!./style.css\";\n       export default content && content.locals ? content.locals : undefined;\n","import React, { useContext, useEffect, useMemo, useState } from \"react\";\r\nimport {\r\n\tAlert,\r\n\tButton,\r\n\tCard,\r\n\tEmpty,\r\n\tSelect,\r\n\tSpace,\r\n\tSpin,\r\n\tTable,\r\n\tTag,\r\n\tTabs,\r\n\tTooltip,\r\n\tTypography,\r\n\tmessage as antMessage,\r\n} from \"antd\";\r\nimport { InfoCircleOutlined } from \"@ant-design/icons\";\r\n\r\nimport {\r\n\tBaseWebPlugin,\r\n\tControlContext,\r\n\tPageHeader,\r\n\tPageLayout,\r\n\tnotifyErrorHandler,\r\n} from \"@clusterio/web_ui\";\r\nimport * as messageDefs from \"../messages\";\r\n\r\nimport \"./style.css\";\r\n\r\nconst {\r\n\tPERMISSIONS,\r\n\tGetPlatformTreeRequest,\r\n\tListTransactionLogsRequest,\r\n\tGetTransactionLogRequest,\r\n\tStartPlatformTransferRequest,\r\n\tSetSurfaceExportSubscriptionRequest,\r\n\tSurfaceExportTreeUpdateEvent,\r\n\tSurfaceExportTransferUpdateEvent,\r\n\tSurfaceExportLogUpdateEvent,\r\n} = messageDefs;\r\n\r\nconst { Text } = Typography;\r\n\r\nfunction statusColor(status) {\r\n\tswitch (status) {\r\n\tcase \"transporting\":\r\n\t\treturn \"processing\";\r\n\tcase \"awaiting_validation\":\r\n\t\treturn \"gold\";\r\n\tcase \"completed\":\r\n\t\treturn \"success\";\r\n\tcase \"failed\":\r\n\tcase \"error\":\r\n\tcase \"cleanup_failed\":\r\n\t\treturn \"error\";\r\n\tdefault:\r\n\t\treturn \"default\";\r\n\t}\r\n}\r\n\r\nfunction summaryFromTransferInfo(transferInfo, lastEventAt = null) {\r\n\tif (!transferInfo) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn {\r\n\t\ttransferId: transferInfo.transferId || transferInfo.id || null,\r\n\t\tplatformName: transferInfo.platformName || \"Unknown\",\r\n\t\tsourceInstanceId: transferInfo.sourceInstanceId ?? -1,\r\n\t\tsourceInstanceName: transferInfo.sourceInstanceName ?? null,\r\n\t\ttargetInstanceId: transferInfo.targetInstanceId ?? -1,\r\n\t\ttargetInstanceName: transferInfo.targetInstanceName ?? null,\r\n\t\tstatus: transferInfo.status || \"unknown\",\r\n\t\tstartedAt: transferInfo.startedAt || Date.now(),\r\n\t\tcompletedAt: transferInfo.completedAt || null,\r\n\t\tfailedAt: transferInfo.failedAt || null,\r\n\t\terror: transferInfo.error || null,\r\n\t\tlastEventAt,\r\n\t};\r\n}\r\n\r\nfunction mergeTransferSummary(existing, incoming) {\r\n\tconst byId = new Map((existing || []).map(summary => [summary.transferId, summary]));\r\n\tif (incoming && incoming.transferId) {\r\n\t\tbyId.set(incoming.transferId, { ...byId.get(incoming.transferId), ...incoming });\r\n\t}\r\n\r\n\treturn Array.from(byId.values()).sort((a, b) => (b.startedAt || 0) - (a.startedAt || 0));\r\n}\r\n\r\nfunction useSurfaceExportPlugin(control) {\r\n\treturn control.plugins.get(\"surface_export\");\r\n}\r\n\r\nfunction useSurfaceExportState(plugin) {\r\n\tconst [state, setState] = useState(plugin.getState());\r\n\r\n\tuseEffect(() => {\r\n\t\tfunction onUpdate() {\r\n\t\t\tsetState(plugin.getState());\r\n\t\t}\r\n\r\n\t\tplugin.onUpdate(onUpdate);\r\n\t\treturn () => plugin.offUpdate(onUpdate);\r\n\t}, [plugin]);\r\n\r\n\treturn state;\r\n}\r\n\r\nfunction ManualTransferTab({ plugin, state }) {\r\n\tconst [selectedPlatformKey, setSelectedPlatformKey] = useState(null);\r\n\tconst [selectedTargetInstance, setSelectedTargetInstance] = useState(null);\r\n\tconst [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n\tconst { tree, loadingTree, treeError } = state;\r\n\tconst latestCompletedByPlatform = useMemo(() => {\r\n\t\tconst completed = new Map();\r\n\t\tfor (const summary of state.transferSummaries || []) {\r\n\t\t\tif (summary?.status === \"completed\" && summary?.platformName && !completed.has(summary.platformName)) {\r\n\t\t\t\tcompleted.set(summary.platformName, summary);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn completed;\r\n\t}, [state.transferSummaries]);\r\n\tconst platformLookup = useMemo(() => {\r\n\t\tconst lookup = new Map();\r\n\t\tif (!tree) {\r\n\t\t\treturn lookup;\r\n\t\t}\r\n\r\n\t\tconst addInstancePlatforms = instance => {\r\n\t\t\tfor (const platform of instance.platforms || []) {\r\n\t\t\t\tconst key = `platform:${instance.instanceId}:${platform.platformIndex}`;\r\n\t\t\t\tlookup.set(key, {\r\n\t\t\t\t\tinstanceId: instance.instanceId,\r\n\t\t\t\t\tinstanceName: instance.instanceName,\r\n\t\t\t\t\tforceName: platform.forceName || tree.forceName || \"player\",\r\n\t\t\t\t\t...platform,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tfor (const host of tree.hosts || []) {\r\n\t\t\tfor (const instance of host.instances || []) {\r\n\t\t\t\taddInstancePlatforms(instance);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (const instance of tree.unassignedInstances || []) {\r\n\t\t\taddInstancePlatforms(instance);\r\n\t\t}\r\n\t\treturn lookup;\r\n\t}, [tree]);\r\n\r\n\tconst instanceListData = useMemo(() => {\r\n\t\tif (!tree) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\r\n\t\tconst rows = [];\r\n\r\n\t\tfor (const host of tree.hosts || []) {\r\n\t\t\tconst sortedInstances = [...(host.instances || [])].sort((a, b) =>\r\n\t\t\t\ta.instanceName.localeCompare(b.instanceName)\r\n\t\t\t);\r\n\r\n\t\t\tfor (const instance of sortedInstances) {\r\n\t\t\t\tfor (const platform of instance.platforms || []) {\r\n\t\t\t\t\trows.push({\r\n\t\t\t\t\t\tkey: `platform:${instance.instanceId}:${platform.platformIndex}`,\r\n\t\t\t\t\t\thostName: host.hostName,\r\n\t\t\t\t\t\thostConnected: host.connected,\r\n\t\t\t\t\t\tinstanceId: instance.instanceId,\r\n\t\t\t\t\t\tinstanceName: instance.instanceName,\r\n\t\t\t\t\t\tinstanceConnected: instance.connected,\r\n\t\t\t\t\t\tinstancePlatformError: instance.platformError,\r\n\t\t\t\t\t\tplatform,\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (tree.unassignedInstances?.length) {\r\n\t\t\tconst sortedUnassigned = [...tree.unassignedInstances].sort((a, b) =>\r\n\t\t\t\ta.instanceName.localeCompare(b.instanceName)\r\n\t\t\t);\r\n\r\n\t\t\tfor (const instance of sortedUnassigned) {\r\n\t\t\t\tfor (const platform of instance.platforms || []) {\r\n\t\t\t\t\trows.push({\r\n\t\t\t\t\t\tkey: `platform:${instance.instanceId}:${platform.platformIndex}`,\r\n\t\t\t\t\t\thostName: \"Unassigned\",\r\n\t\t\t\t\t\thostConnected: null,\r\n\t\t\t\t\t\tinstanceId: instance.instanceId,\r\n\t\t\t\t\t\tinstanceName: instance.instanceName,\r\n\t\t\t\t\t\tinstanceConnected: instance.connected,\r\n\t\t\t\t\t\tinstancePlatformError: instance.platformError,\r\n\t\t\t\t\t\tplatform,\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (latestCompletedByPlatform.size) {\r\n\t\t\tconst platformTargets = new Map();\r\n\t\t\tfor (const [platformName, summary] of latestCompletedByPlatform.entries()) {\r\n\t\t\t\tconst hasTarget = rows.some(row => (\r\n\t\t\t\t\trow.platform?.platformName === platformName\r\n\t\t\t\t\t&& row.instanceId === summary.targetInstanceId\r\n\t\t\t\t));\r\n\t\t\t\tif (hasTarget) {\r\n\t\t\t\t\tplatformTargets.set(platformName, summary.targetInstanceId);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn rows.filter(row => {\r\n\t\t\t\tconst platformName = row.platform?.platformName;\r\n\t\t\t\tconst targetInstanceId = platformTargets.get(platformName);\r\n\t\t\t\tif (!targetInstanceId) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\treturn row.instanceId === targetInstanceId;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn rows;\r\n\t}, [tree, latestCompletedByPlatform]);\r\n\r\n\tconst selectedSource = selectedPlatformKey ? platformLookup.get(selectedPlatformKey) : null;\r\n\r\n\tconst destinationOptions = useMemo(() => {\r\n\t\tif (!tree) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\r\n\t\tconst instanceNodes = [];\r\n\t\tfor (const host of tree.hosts || []) {\r\n\t\t\tfor (const instance of host.instances || []) {\r\n\t\t\t\tinstanceNodes.push(instance);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (const instance of tree.unassignedInstances || []) {\r\n\t\t\tinstanceNodes.push(instance);\r\n\t\t}\r\n\r\n\t\treturn instanceNodes\r\n\t\t\t.filter(instance => instance.instanceId !== selectedSource?.instanceId)\r\n\t\t\t.map(instance => ({\r\n\t\t\t\tlabel: `${instance.instanceName} (${instance.instanceId})`,\r\n\t\t\t\tvalue: instance.instanceId,\r\n\t\t\t}));\r\n\t}, [tree, selectedSource]);\r\n\r\n\tasync function submitTransfer() {\r\n\t\tif (!selectedSource || selectedTargetInstance === null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tsetIsSubmitting(true);\r\n\t\ttry {\r\n\t\t\tconst response = await plugin.startTransfer({\r\n\t\t\t\tsourceInstanceId: selectedSource.instanceId,\r\n\t\t\t\tsourcePlatformIndex: selectedSource.platformIndex,\r\n\t\t\t\ttargetInstanceId: Number(selectedTargetInstance),\r\n\t\t\t\tforceName: selectedSource.forceName || \"player\",\r\n\t\t\t});\r\n\t\t\tif (!response.success) {\r\n\t\t\t\tconst errorDetails = [\r\n\t\t\t\t\t`Error: ${response.error || \"Unknown error\"}`,\r\n\t\t\t\t\t`Source: Instance ${selectedSource.instanceId} (${selectedSource.instanceName})`,\r\n\t\t\t\t\t`Platform: ${selectedSource.platformName} (index ${selectedSource.platformIndex})`,\r\n\t\t\t\t\t`Target: Instance ${selectedTargetInstance}`,\r\n\t\t\t\t].join(\" | \");\r\n\t\t\t\tconsole.error(\"[Surface Export] Transfer failed:\", errorDetails);\r\n\t\t\t\tthrow new Error(response.error || \"Transfer start failed\");\r\n\t\t\t}\r\n\t\t\tconsole.info(`[Surface Export] Transfer started: ${response.transferId}`);\r\n\t\t\tantMessage.success(\r\n\t\t\t\t`Transfer started: ${response.transferId}`,\r\n\t\t\t\t5  // Show for 5 seconds\r\n\t\t\t);\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error(\"[Surface Export] Transfer submission error:\", err);\r\n\t\t\tantMessage.error(\r\n\t\t\t\terr.message || \"Failed to start transfer\",\r\n\t\t\t\t10  // Show error for 10 seconds\r\n\t\t\t);\r\n\t\t} finally {\r\n\t\t\tsetIsSubmitting(false);\r\n\t\t}\r\n\t}\r\n\r\n\tconst instanceColumns = [\r\n\t\t{\r\n\t\t\ttitle: \"Host\",\r\n\t\t\tdataIndex: \"hostName\",\r\n\t\t\tkey: \"hostName\",\r\n\t\t\twidth: \"15%\",\r\n\t\t\trender: (hostName, row) => (\r\n\t\t\t\t<Space>\r\n\t\t\t\t\t<Text>{hostName}</Text>\r\n\t\t\t\t\t{row.hostConnected !== null ? (\r\n\t\t\t\t\t\t<Tag color={row.hostConnected ? \"green\" : \"default\"}>\r\n\t\t\t\t\t\t\t{row.hostConnected ? \"online\" : \"offline\"}\r\n\t\t\t\t\t\t</Tag>\r\n\t\t\t\t\t) : null}\r\n\t\t\t\t</Space>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Instance\",\r\n\t\t\tdataIndex: \"instanceName\",\r\n\t\t\tkey: \"instanceName\",\r\n\t\t\twidth: \"25%\",\r\n\t\t\trender: (instanceName, row) => (\r\n\t\t\t\t<Space>\r\n\t\t\t\t\t<Text>{instanceName}</Text>\r\n\t\t\t\t\t<Tag color={row.instanceConnected ? \"green\" : \"default\"}>\r\n\t\t\t\t\t\t{row.instanceConnected ? \"connected\" : \"disconnected\"}\r\n\t\t\t\t\t</Tag>\r\n\t\t\t\t\t{row.instancePlatformError ? <Tag color=\"warning\">error</Tag> : null}\r\n\t\t\t\t</Space>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Platform\",\r\n\t\t\tkey: \"platform\",\r\n\t\t\twidth: \"40%\",\r\n\t\t\trender: (_, row) => (\r\n\t\t\t\t<Space>\r\n\t\t\t\t\t<Text>{row.platform.platformName}</Text>\r\n\t\t\t\t\t<Tag color={statusColor(row.platform.transferStatus)}>\r\n\t\t\t\t\t\t{row.platform.transferStatus || \"idle\"}\r\n\t\t\t\t\t</Tag>\r\n\t\t\t\t\t{row.platform.hasSpaceHub === false ? (\r\n\t\t\t\t\t\t<Tag color=\"warning\">no hub</Tag>\r\n\t\t\t\t\t) : null}\r\n\t\t\t\t</Space>\r\n\t\t\t),\r\n\t\t},\r\n\t];\r\n\tconst flowColumns = [\r\n\t\t{\r\n\t\t\ttitle: \"At\",\r\n\t\t\tkey: \"at\",\r\n\t\t\twidth: \"16%\",\r\n\t\t\trender: (_, row) => row.timestamp ? new Date(row.timestamp).toLocaleTimeString() : \"-\",\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Step\",\r\n\t\t\tdataIndex: \"eventType\",\r\n\t\t\tkey: \"eventType\",\r\n\t\t\twidth: \"20%\",\r\n\t\t\trender: (eventType, row) => <Tag color={row.color}>{eventType}</Tag>,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Elapsed\",\r\n\t\t\tdataIndex: \"elapsedMs\",\r\n\t\t\tkey: \"elapsedMs\",\r\n\t\t\twidth: \"10%\",\r\n\t\t\trender: value => (typeof value === \"number\" ? `${formatNumeric(value, 0)} ms` : \"-\"),\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Î” Prev\",\r\n\t\t\tdataIndex: \"deltaMs\",\r\n\t\t\tkey: \"deltaMs\",\r\n\t\t\twidth: \"10%\",\r\n\t\t\trender: value => (typeof value === \"number\" ? `${formatNumeric(value, 0)} ms` : \"-\"),\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Duration\",\r\n\t\t\tkey: \"duration\",\r\n\t\t\twidth: \"12%\",\r\n\t\t\trender: (_, row) => {\r\n\t\t\t\tif (typeof row.durationMs === \"number\") {\r\n\t\t\t\t\treturn `${formatNumeric(row.durationMs, 0)} ms`;\r\n\t\t\t\t}\r\n\t\t\t\tif (row.phaseTimings?.length) {\r\n\t\t\t\t\tconst totalPhaseMs = row.phaseTimings.reduce((sum, phase) => sum + (Number(phase.durationMs) || 0), 0);\r\n\t\t\t\t\treturn `${formatNumeric(totalPhaseMs, 0)} ms`;\r\n\t\t\t\t}\r\n\t\t\t\treturn \"-\";\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Message\",\r\n\t\t\tdataIndex: \"message\",\r\n\t\t\tkey: \"message\",\r\n\t\t},\r\n\t];\r\n\tconst entityExpectedTotal = Number(validation?.entityCount ?? entityRows.reduce((sum, row) => sum + (Number(row.count) || 0), 0));\r\n\tconst entityActualTotal = entityRows.reduce((sum, row) => sum + (Number(row.count) || 0), 0);\r\n\tconst validationCategoryRows = useMemo(() => {\r\n\t\tif (!validation) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t\treturn [\r\n\t\t\t{\r\n\t\t\t\tkey: \"validation:entities\",\r\n\t\t\t\tcategory: \"Entities\",\r\n\t\t\t\texpected: entityExpectedTotal,\r\n\t\t\t\tactual: entityActualTotal,\r\n\t\t\t\tdelta: entityActualTotal - entityExpectedTotal,\r\n\t\t\t\tpreservedPct: entityExpectedTotal > 0 ? (entityActualTotal / entityExpectedTotal) * 100 : null,\r\n\t\t\t\tstatus: Math.abs(entityActualTotal - entityExpectedTotal) <= 0.0001 ? \"Match\" : \"Mismatch\",\r\n\t\t\t\tdetailCount: entityRows.length,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tkey: \"validation:items\",\r\n\t\t\t\tcategory: \"Items\",\r\n\t\t\t\texpected: itemExpectedTotal,\r\n\t\t\t\tactual: itemActualTotal,\r\n\t\t\t\tdelta: itemActualTotal - itemExpectedTotal,\r\n\t\t\t\tpreservedPct: itemExpectedTotal > 0 ? (itemActualTotal / itemExpectedTotal) * 100 : null,\r\n\t\t\t\tstatus: validation.itemCountMatch ? \"Match\" : \"Mismatch\",\r\n\t\t\t\tdetailCount: itemRows.length,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tkey: \"validation:fluids\",\r\n\t\t\t\tcategory: \"Fluids\",\r\n\t\t\t\texpected: fluidExpectedTotal,\r\n\t\t\t\tactual: fluidActualTotal,\r\n\t\t\t\tdelta: fluidActualTotal - fluidExpectedTotal,\r\n\t\t\t\tpreservedPct: fluidExpectedTotal > 0 ? (fluidActualTotal / fluidExpectedTotal) * 100 : null,\r\n\t\t\t\tstatus: validation.fluidCountMatch ? \"Match\" : \"Mismatch\",\r\n\t\t\t\tdetailCount: fluidInventoryRows.length,\r\n\t\t\t},\r\n\t\t];\r\n\t}, [\r\n\t\tvalidation,\r\n\t\tentityExpectedTotal,\r\n\t\tentityActualTotal,\r\n\t\tentityRows,\r\n\t\titemExpectedTotal,\r\n\t\titemActualTotal,\r\n\t\titemRows,\r\n\t\tfluidExpectedTotal,\r\n\t\tfluidActualTotal,\r\n\t\tfluidInventoryRows,\r\n\t]);\r\n\tconst validationCategoryColumns = [\r\n\t\t{\r\n\t\t\ttitle: \"Category\",\r\n\t\t\tdataIndex: \"category\",\r\n\t\t\tkey: \"category\",\r\n\t\t\trender: value => <Text strong>{value}</Text>,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Expected\",\r\n\t\t\tdataIndex: \"expected\",\r\n\t\t\tkey: \"expected\",\r\n\t\t\trender: value => formatNumeric(value, 1),\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Actual\",\r\n\t\t\tdataIndex: \"actual\",\r\n\t\t\tkey: \"actual\",\r\n\t\t\trender: value => formatNumeric(value, 1),\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Î”\",\r\n\t\t\tdataIndex: \"delta\",\r\n\t\t\tkey: \"delta\",\r\n\t\t\trender: value => (\r\n\t\t\t\t<Text type={value === 0 ? undefined : value > 0 ? \"success\" : \"danger\"}>\r\n\t\t\t\t\t{formatSigned(value, 1)}\r\n\t\t\t\t</Text>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Preserved\",\r\n\t\t\tdataIndex: \"preservedPct\",\r\n\t\t\tkey: \"preservedPct\",\r\n\t\t\trender: value => (value === null ? \"-\" : `${formatNumeric(value, 1)}%`),\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Status\",\r\n\t\t\tdataIndex: \"status\",\r\n\t\t\tkey: \"status\",\r\n\t\t\trender: status => (\r\n\t\t\t\t<Tag color={status === \"Match\" ? \"green\" : \"warning\"}>\r\n\t\t\t\t\t{status}\r\n\t\t\t\t</Tag>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Details\",\r\n\t\t\tdataIndex: \"detailCount\",\r\n\t\t\tkey: \"detailCount\",\r\n\t\t\trender: value => `${formatNumeric(value, 0)} rows`,\r\n\t\t},\r\n\t];\r\n\r\n\treturn (\r\n\t\t<div className=\"surface-export-tab-body\">\r\n\t\t\t<div className=\"surface-export-tree-panel\">\r\n\t\t\t\t<Card title=\"Available Platforms\">\r\n\t\t\t\t\t{loadingTree ? <Spin /> : null}\r\n\t\t\t\t\t{treeError ? <Alert type=\"error\" showIcon message={treeError} /> : null}\r\n\t\t\t\t\t{!loadingTree && !instanceListData.length ? <Empty description=\"No platforms found\" /> : null}\r\n\t\t\t\t\t{instanceListData.length ? (\r\n\t\t\t\t\t\t<Table\r\n\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\tcolumns={instanceColumns}\r\n\t\t\t\t\t\t\tdataSource={instanceListData}\r\n\t\t\t\t\t\t\trowKey={row => row.key}\r\n\t\t\t\t\t\t\tpagination={{ pageSize: 15 }}\r\n\t\t\t\t\t\t\trowClassName={row => row.key === selectedPlatformKey ? \"surface-export-log-row-selected\" : \"surface-export-log-row\"}\r\n\t\t\t\t\t\t\tonRow={row => ({\r\n\t\t\t\t\t\t\t\tonClick: () => {\r\n\t\t\t\t\t\t\t\t\tif (row.platform?.hasSpaceHub === false) {\r\n\t\t\t\t\t\t\t\t\t\tantMessage.warning(\"This platform does not have a space hub yet.\");\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tsetSelectedPlatformKey(row.key);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t) : null}\r\n\t\t\t\t</Card>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className=\"surface-export-action-panel\">\r\n\t\t\t\t<Card title=\"Manual Transfer\">\r\n\t\t\t\t\t<Space direction=\"vertical\" size=\"middle\" style={{ width: \"100%\" }}>\r\n\t\t\t\t\t\t{selectedSource ? (\r\n\t\t\t\t\t\t\t<Alert\r\n\t\t\t\t\t\t\t\ttype=\"info\"\r\n\t\t\t\t\t\t\t\tshowIcon\r\n\t\t\t\t\t\t\t\tmessage={`Source: ${selectedSource.platformName}`}\r\n\t\t\t\t\t\t\t\tdescription={`Instance ${selectedSource.instanceName} (${selectedSource.instanceId})`}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<Alert type=\"warning\" showIcon message=\"Select a source platform in the tree\" />\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\tplaceholder=\"Select destination instance\"\r\n\t\t\t\t\t\t\toptions={destinationOptions}\r\n\t\t\t\t\t\t\tvalue={selectedTargetInstance}\r\n\t\t\t\t\t\t\tonChange={setSelectedTargetInstance}\r\n\t\t\t\t\t\t\tdisabled={!selectedSource}\r\n\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\ttype=\"primary\"\r\n\t\t\t\t\t\t\tonClick={submitTransfer}\r\n\t\t\t\t\t\t\tdisabled={!selectedSource || selectedTargetInstance === null}\r\n\t\t\t\t\t\t\tloading={isSubmitting}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tStart Transfer\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Space>\r\n\t\t\t\t</Card>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nfunction humanizeMetricKey(key) {\r\n\treturn String(key || \"\")\r\n\t\t.replace(/_/g, \" \")\r\n\t\t.replace(/([a-z])([A-Z])/g, \"$1 $2\")\r\n\t\t.replace(/\\s+/g, \" \")\r\n\t\t.trim()\r\n\t\t.replace(/^./, text => text.toUpperCase());\r\n}\r\n\r\nfunction formatDuration(durationMs) {\r\n\tif (typeof durationMs !== \"number\" || Number.isNaN(durationMs)) {\r\n\t\treturn \"-\";\r\n\t}\r\n\tif (durationMs >= 1000) {\r\n\t\treturn `${(durationMs / 1000).toFixed(1)}s (${Math.round(durationMs).toLocaleString()}ms)`;\r\n\t}\r\n\treturn `${Math.round(durationMs).toLocaleString()}ms`;\r\n}\r\n\r\nfunction formatNumeric(value, maxFractionDigits = 1) {\r\n\tif (typeof value !== \"number\" || Number.isNaN(value)) {\r\n\t\treturn \"-\";\r\n\t}\r\n\treturn value.toLocaleString(undefined, { maximumFractionDigits: maxFractionDigits });\r\n}\r\n\r\nfunction formatSigned(value, maxFractionDigits = 1) {\r\n\tif (typeof value !== \"number\" || Number.isNaN(value)) {\r\n\t\treturn \"-\";\r\n\t}\r\n\tconst sign = value > 0 ? \"+\" : \"\";\r\n\treturn `${sign}${value.toLocaleString(undefined, { maximumFractionDigits: maxFractionDigits })}`;\r\n}\r\n\r\nfunction sumValues(map) {\r\n\treturn Object.values(map || {}).reduce((total, value) => {\r\n\t\tconst numeric = Number(value);\r\n\t\treturn Number.isFinite(numeric) ? total + numeric : total;\r\n\t}, 0);\r\n}\r\n\r\nfunction buildMetricRows(data) {\r\n\tif (!data || typeof data !== \"object\") {\r\n\t\treturn [];\r\n\t}\r\n\r\n\treturn Object.entries(data).map(([key, value]) => {\r\n\t\tlet formattedValue = \"-\";\r\n\t\tif (typeof value === \"boolean\") {\r\n\t\t\tformattedValue = value ? \"Yes\" : \"No\";\r\n\t\t} else if (typeof value === \"number\") {\r\n\t\t\tconst lowered = key.toLowerCase();\r\n\t\t\tif (lowered.endsWith(\"ms\")) {\r\n\t\t\t\tformattedValue = `${formatNumeric(value, 0)} ms`;\r\n\t\t\t} else if (lowered.endsWith(\"ticks\")) {\r\n\t\t\t\tformattedValue = `${formatNumeric(value, 0)} ticks`;\r\n\t\t\t} else if (lowered.endsWith(\"kb\")) {\r\n\t\t\t\tformattedValue = `${formatNumeric(value, 1)} KB`;\r\n\t\t\t} else {\r\n\t\t\t\tformattedValue = formatNumeric(value, Number.isInteger(value) ? 0 : 1);\r\n\t\t\t}\r\n\t\t} else if (value !== null && value !== undefined) {\r\n\t\t\tformattedValue = String(value);\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tkey,\r\n\t\t\tmetric: humanizeMetricKey(key),\r\n\t\t\tvalue: formattedValue,\r\n\t\t};\r\n\t});\r\n}\r\n\r\nfunction buildExpectedActualRows(expectedMap, actualMap) {\r\n\tconst expected = expectedMap || {};\r\n\tconst actual = actualMap || {};\r\n\tconst keys = new Set([ ...Object.keys(expected), ...Object.keys(actual) ]);\r\n\tconst rows = [];\r\n\tfor (const name of keys) {\r\n\t\tconst expectedValue = Number(expected[name] || 0);\r\n\t\tconst actualValue = Number(actual[name] || 0);\r\n\t\tconst delta = actualValue - expectedValue;\r\n\t\trows.push({\r\n\t\t\tkey: name,\r\n\t\t\tname,\r\n\t\t\texpected: expectedValue,\r\n\t\t\tactual: actualValue,\r\n\t\t\tdelta,\r\n\t\t\tpreservedPct: expectedValue > 0 ? (actualValue / expectedValue) * 100 : null,\r\n\t\t});\r\n\t}\r\n\trows.sort((a, b) => Math.abs(b.delta) - Math.abs(a.delta) || a.name.localeCompare(b.name));\r\n\treturn rows;\r\n}\r\n\r\nfunction parseFluidTemperatureKey(fluidKey) {\r\n\tconst key = String(fluidKey || \"\");\r\n\tconst match = key.match(/^(.*)@(-?\\d+(?:\\.\\d+)?)C$/i);\r\n\tif (!match) {\r\n\t\treturn {\r\n\t\t\tbaseName: key,\r\n\t\t\ttemperatureC: null,\r\n\t\t\trawKey: key,\r\n\t\t};\r\n\t}\r\n\treturn {\r\n\t\tbaseName: match[1] || key,\r\n\t\ttemperatureC: Number(match[2]),\r\n\t\trawKey: key,\r\n\t};\r\n}\r\n\r\nfunction buildFluidInventoryRows(expectedMap, actualMap, highTempThreshold = 10000, highTempAggregates = {}) {\r\n\tconst expected = expectedMap || {};\r\n\tconst actual = actualMap || {};\r\n\tconst aggregates = highTempAggregates || {};\r\n\tconst threshold = Number.isFinite(Number(highTempThreshold)) ? Number(highTempThreshold) : 10000;\r\n\tconst keys = new Set([ ...Object.keys(expected), ...Object.keys(actual) ]);\r\n\tconst groups = new Map();\r\n\r\n\tfor (const fluidKey of keys) {\r\n\t\tconst expectedValue = Number(expected[fluidKey] || 0);\r\n\t\tconst actualValue = Number(actual[fluidKey] || 0);\r\n\t\tconst delta = actualValue - expectedValue;\r\n\t\tconst parsed = parseFluidTemperatureKey(fluidKey);\r\n\t\tconst isHighTemp = parsed.temperatureC !== null && parsed.temperatureC >= threshold;\r\n\t\tconst baseName = parsed.baseName || fluidKey;\r\n\r\n\t\tif (!groups.has(baseName)) {\r\n\t\t\tgroups.set(baseName, {\r\n\t\t\t\tbaseName,\r\n\t\t\t\texpected: 0,\r\n\t\t\t\tactual: 0,\r\n\t\t\t\thasHighTempBucket: false,\r\n\t\t\t\tchildren: [],\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tconst group = groups.get(baseName);\r\n\t\tgroup.expected += expectedValue;\r\n\t\tgroup.actual += actualValue;\r\n\t\tgroup.hasHighTempBucket = group.hasHighTempBucket || isHighTemp;\r\n\t\tgroup.children.push({\r\n\t\t\tkey: `fluid:bucket:${fluidKey}`,\r\n\t\t\tname: baseName,\r\n\t\t\tbucketKey: fluidKey,\r\n\t\t\ttempBucket: parsed.temperatureC === null ? \"-\" : `${formatNumeric(parsed.temperatureC, 1)}Â°C`,\r\n\t\t\tcategory: isHighTemp ? \"High-temp\" : \"Normal\",\r\n\t\t\texpected: expectedValue,\r\n\t\t\tactual: actualValue,\r\n\t\t\tdelta,\r\n\t\t\tpreservedPct: expectedValue > 0 ? (actualValue / expectedValue) * 100 : null,\r\n\t\t\tisGroup: false,\r\n\t\t\tstatus: \"Match\",\r\n\t\t\treconciled: false,\r\n\t\t});\r\n\t}\r\n\r\n\tconst rows = [];\r\n\tfor (const group of groups.values()) {\r\n\t\tconst delta = group.actual - group.expected;\r\n\t\tconst category = group.hasHighTempBucket ? \"High-temp\" : \"Normal\";\r\n\t\tconst aggregate = aggregates[group.baseName];\r\n\t\tconst reconciledHighTemp = category === \"High-temp\"\r\n\t\t\t? Boolean(aggregate?.reconciled ?? Math.abs(delta) <= 1)\r\n\t\t\t: false;\r\n\r\n\t\tconst children = group.children\r\n\t\t\t.map(child => {\r\n\t\t\t\tconst absDelta = Math.abs(child.delta);\r\n\t\t\t\tlet status = \"Match\";\r\n\t\t\t\tif (child.category === \"High-temp\" && reconciledHighTemp) {\r\n\t\t\t\t\tstatus = absDelta > 0.0001 ? \"Bucket drift (reconciled)\" : \"Match\";\r\n\t\t\t\t} else if (absDelta > 0.0001) {\r\n\t\t\t\t\tstatus = \"Mismatch\";\r\n\t\t\t\t}\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...child,\r\n\t\t\t\t\tstatus,\r\n\t\t\t\t\treconciled: child.category === \"High-temp\" ? reconciledHighTemp : absDelta <= 0.0001,\r\n\t\t\t\t};\r\n\t\t\t})\r\n\t\t\t.sort((a, b) => Math.abs(b.delta) - Math.abs(a.delta) || a.bucketKey.localeCompare(b.bucketKey));\r\n\r\n\t\trows.push({\r\n\t\t\tkey: `fluid:group:${group.baseName}`,\r\n\t\t\tname: group.baseName,\r\n\t\t\tcategory,\r\n\t\t\texpected: group.expected,\r\n\t\t\tactual: group.actual,\r\n\t\t\tdelta,\r\n\t\t\tpreservedPct: group.expected > 0 ? (group.actual / group.expected) * 100 : null,\r\n\t\t\tisGroup: true,\r\n\t\t\tstatus: category === \"High-temp\"\r\n\t\t\t\t? (reconciledHighTemp ? \"Reconciled aggregate\" : (Math.abs(delta) <= 0.0001 ? \"Match\" : \"Mismatch\"))\r\n\t\t\t\t: (Math.abs(delta) <= 0.0001 ? \"Match\" : \"Mismatch\"),\r\n\t\t\treconciled: category === \"High-temp\" ? reconciledHighTemp : Math.abs(delta) <= 0.0001,\r\n\t\t\tchildren,\r\n\t\t});\r\n\t}\r\n\r\n\trows.sort((a, b) => Math.abs(b.delta) - Math.abs(a.delta) || a.name.localeCompare(b.name));\r\n\treturn rows;\r\n}\r\n\r\nfunction findLatestEvent(events, predicate) {\r\n\tfor (let index = events.length - 1; index >= 0; index -= 1) {\r\n\t\tif (predicate(events[index])) {\r\n\t\t\treturn events[index];\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction buildDetailedLogSummary(detail, transferId) {\r\n\tconst transferInfo = detail?.transferInfo || null;\r\n\tconst events = Array.isArray(detail?.events) ? detail.events : [];\r\n\tconst summary = detail?.summary && typeof detail.summary === \"object\" ? detail.summary : {};\r\n\r\n\tconst transferCreatedEvent = findLatestEvent(events, event => event?.eventType === \"transfer_created\");\r\n\tconst validationEvent = findLatestEvent(events, event => (\r\n\t\tevent?.eventType === \"validation_received\"\r\n\t\t|| event?.eventType === \"validation_failed\"\r\n\t\t|| event?.validation\r\n\t));\r\n\tconst completionEvent = findLatestEvent(events, event => (\r\n\t\tevent?.eventType === \"transfer_completed\"\r\n\t\t|| event?.eventType === \"transfer_failed\"\r\n\t));\r\n\tconst latestEvent = events.length ? events[events.length - 1] : null;\r\n\r\n\tconst status = transferInfo?.status || summary.status || \"unknown\";\r\n\tlet result = summary.result;\r\n\tif (!result) {\r\n\t\tif (status === \"completed\") {\r\n\t\t\tresult = \"SUCCESS\";\r\n\t\t} else if ([ \"failed\", \"error\", \"cleanup_failed\" ].includes(status)) {\r\n\t\t\tresult = \"FAILED\";\r\n\t\t} else {\r\n\t\t\tresult = \"IN_PROGRESS\";\r\n\t\t}\r\n\t}\r\n\r\n\tconst startedAt = transferInfo?.startedAt || summary.startedAt || transferCreatedEvent?.timestampMs || null;\r\n\tconst completedAt = transferInfo?.completedAt || summary.completedAt || null;\r\n\tconst failedAt = transferInfo?.failedAt || summary.failedAt || null;\r\n\tconst lastEventAt = summary.lastEventAt || latestEvent?.timestampMs || null;\r\n\tconst finishedAt = completedAt || failedAt || completionEvent?.timestampMs || lastEventAt;\r\n\tlet totalDurationMs = typeof summary.totalDurationMs === \"number\" ? summary.totalDurationMs : null;\r\n\tif (totalDurationMs === null && startedAt && finishedAt) {\r\n\t\ttotalDurationMs = Math.max(0, finishedAt - startedAt);\r\n\t}\r\n\tif (totalDurationMs === null && typeof completionEvent?.durationMs === \"number\") {\r\n\t\ttotalDurationMs = completionEvent.durationMs;\r\n\t}\r\n\r\n\tconst validation = summary.validation || validationEvent?.validation || null;\r\n\tlet sourceVerification = summary.sourceVerification || transferCreatedEvent?.sourceVerification || null;\r\n\tif (!sourceVerification && validation) {\r\n\t\tsourceVerification = {\r\n\t\t\titemCounts: validation.expectedItemCounts || {},\r\n\t\t\tfluidCounts: validation.expectedFluidCounts || {},\r\n\t\t};\r\n\t}\r\n\r\n\treturn {\r\n\t\ttransferId,\r\n\t\tresult,\r\n\t\tstatus,\r\n\t\ttotalDurationMs,\r\n\t\ttotalDurationStr: summary.totalDurationStr || formatDuration(totalDurationMs),\r\n\t\tphases: summary.phases || completionEvent?.phases || {},\r\n\t\tplatform: summary.platform || {\r\n\t\t\tname: transferInfo?.platformName || \"Unknown\",\r\n\t\t\tsource: {\r\n\t\t\t\tinstanceId: transferInfo?.sourceInstanceId ?? -1,\r\n\t\t\t\tinstanceName: transferInfo?.sourceInstanceName ?? null,\r\n\t\t\t},\r\n\t\t\tdestination: {\r\n\t\t\t\tinstanceId: transferInfo?.targetInstanceId ?? -1,\r\n\t\t\t\tinstanceName: transferInfo?.targetInstanceName ?? null,\r\n\t\t\t},\r\n\t\t},\r\n\t\texport: summary.export || transferCreatedEvent?.exportMetrics || null,\r\n\t\tpayload: summary.payload || completionEvent?.payloadMetrics || transferCreatedEvent?.payloadMetrics || null,\r\n\t\timport: summary.import || completionEvent?.importMetrics || validationEvent?.importMetrics || null,\r\n\t\tvalidation,\r\n\t\tsourceVerification,\r\n\t\tstartedAt,\r\n\t\tcompletedAt,\r\n\t\tfailedAt,\r\n\t\tlastEventAt,\r\n\t\terror: summary.error || transferInfo?.error || null,\r\n\t};\r\n}\r\n\r\nfunction TransactionLogsTab({ plugin, state }) {\r\n\tconst [selectedTransferId, setSelectedTransferId] = useState(null);\r\n\tconst selectedDetails = selectedTransferId ? state.logDetails[selectedTransferId] : null;\r\n\tconst detailedSummary = useMemo(\r\n\t\t() => (selectedDetails ? buildDetailedLogSummary(selectedDetails, selectedTransferId) : null),\r\n\t\t[selectedDetails, selectedTransferId]\r\n\t);\r\n\r\n\tconst columns = [\r\n\t\t{\r\n\t\t\ttitle: \"Transfer\",\r\n\t\t\tdataIndex: \"transferId\",\r\n\t\t\tkey: \"transferId\",\r\n\t\t\trender: transferId => <Text code>{transferId}</Text>,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Platform\",\r\n\t\t\tdataIndex: \"platformName\",\r\n\t\t\tkey: \"platformName\",\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Source\",\r\n\t\t\tkey: \"source\",\r\n\t\t\trender: (_, row) => row.sourceInstanceName || row.sourceInstanceId,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Destination\",\r\n\t\t\tkey: \"destination\",\r\n\t\t\trender: (_, row) => row.targetInstanceName || row.targetInstanceId,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Status\",\r\n\t\t\tdataIndex: \"status\",\r\n\t\t\tkey: \"status\",\r\n\t\t\trender: status => <Tag color={statusColor(status)}>{status}</Tag>,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Started\",\r\n\t\t\tdataIndex: \"startedAt\",\r\n\t\t\tkey: \"startedAt\",\r\n\t\t\trender: startedAt => startedAt ? new Date(startedAt).toLocaleString() : \"-\",\r\n\t\t},\r\n\t];\r\n\tconst metricColumns = [\r\n\t\t{\r\n\t\t\ttitle: \"Metric\",\r\n\t\t\tdataIndex: \"metric\",\r\n\t\t\tkey: \"metric\",\r\n\t\t\twidth: \"60%\",\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Value\",\r\n\t\t\tdataIndex: \"value\",\r\n\t\t\tkey: \"value\",\r\n\t\t},\r\n\t];\r\n\tconst comparisonColumns = [\r\n\t\t{\r\n\t\t\ttitle: \"Key\",\r\n\t\t\tdataIndex: \"name\",\r\n\t\t\tkey: \"name\",\r\n\t\t\twidth: \"40%\",\r\n\t\t\trender: name => <Text code>{name}</Text>,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Expected\",\r\n\t\t\tdataIndex: \"expected\",\r\n\t\t\tkey: \"expected\",\r\n\t\t\trender: value => formatNumeric(value, Number.isInteger(value) ? 0 : 1),\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Actual\",\r\n\t\t\tdataIndex: \"actual\",\r\n\t\t\tkey: \"actual\",\r\n\t\t\trender: value => formatNumeric(value, Number.isInteger(value) ? 0 : 1),\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Î”\",\r\n\t\t\tdataIndex: \"delta\",\r\n\t\t\tkey: \"delta\",\r\n\t\t\trender: delta => (\r\n\t\t\t\t<Text type={delta === 0 ? undefined : delta > 0 ? \"success\" : \"danger\"}>\r\n\t\t\t\t\t{formatSigned(delta, Number.isInteger(delta) ? 0 : 1)}\r\n\t\t\t\t</Text>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Preserved\",\r\n\t\t\tdataIndex: \"preservedPct\",\r\n\t\t\tkey: \"preservedPct\",\r\n\t\t\trender: value => (value === null ? \"-\" : `${formatNumeric(value, 1)}%`),\r\n\t\t},\r\n\t];\r\n\r\n\tconst flowRows = useMemo(\r\n\t\t() => (selectedDetails?.events || []).map((event, index) => {\r\n\t\t\tconst phaseTimings = [];\r\n\t\t\tif (typeof event?.transmissionMs === \"number\") {\r\n\t\t\t\tphaseTimings.push({ key: \"transmission\", phase: \"Transmission\", durationMs: event.transmissionMs, source: \"transfer\" });\r\n\t\t\t}\r\n\t\t\tif (typeof event?.validationMs === \"number\") {\r\n\t\t\t\tphaseTimings.push({ key: \"validation\", phase: \"Validation\", durationMs: event.validationMs, source: \"transfer\" });\r\n\t\t\t}\r\n\t\t\tif (event?.phases && typeof event.phases === \"object\") {\r\n\t\t\t\tfor (const [phaseName, phaseDurationMs] of Object.entries(event.phases)) {\r\n\t\t\t\t\tif (typeof phaseDurationMs === \"number\") {\r\n\t\t\t\t\t\tphaseTimings.push({\r\n\t\t\t\t\t\t\tkey: `phase:${phaseName}`,\r\n\t\t\t\t\t\t\tphase: humanizeMetricKey(String(phaseName).replace(/Ms$/, \"\")),\r\n\t\t\t\t\t\t\tdurationMs: phaseDurationMs,\r\n\t\t\t\t\t\t\tsource: \"phase\",\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (event?.importMetrics && typeof event.importMetrics === \"object\") {\r\n\t\t\t\tconst importPhaseKeys = [\r\n\t\t\t\t\t[ \"tiles_ms\", \"Import: Tiles\" ],\r\n\t\t\t\t\t[ \"entities_ms\", \"Import: Entities\" ],\r\n\t\t\t\t\t[ \"fluids_ms\", \"Import: Fluids\" ],\r\n\t\t\t\t\t[ \"belts_ms\", \"Import: Belts\" ],\r\n\t\t\t\t\t[ \"state_ms\", \"Import: State Restore\" ],\r\n\t\t\t\t\t[ \"validation_ms\", \"Import: Validation\" ],\r\n\t\t\t\t\t[ \"total_ms\", \"Import: Total\" ],\r\n\t\t\t\t];\r\n\t\t\t\tfor (const [metricKey, label] of importPhaseKeys) {\r\n\t\t\t\t\tconst value = event.importMetrics?.[metricKey];\r\n\t\t\t\t\tif (typeof value === \"number\") {\r\n\t\t\t\t\t\tphaseTimings.push({\r\n\t\t\t\t\t\t\tkey: `import:${metricKey}`,\r\n\t\t\t\t\t\t\tphase: label,\r\n\t\t\t\t\t\t\tdurationMs: value,\r\n\t\t\t\t\t\t\tsource: \"import\",\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst primaryDurationMs = [event?.durationMs, event?.validationMs, event?.transmissionMs]\r\n\t\t\t\t.find(value => typeof value === \"number\") ?? null;\r\n\t\t\tconst isFailure = String(event?.eventType || \"\").includes(\"failed\") || String(event?.eventType || \"\").includes(\"error\");\r\n\t\t\tconst isSuccess = String(event?.eventType || \"\").includes(\"completed\") || String(event?.eventType || \"\").includes(\"success\");\r\n\r\n\t\t\treturn {\r\n\t\t\t\tkey: `flow:${event?.timestampMs || Date.now()}:${index}`,\r\n\t\t\t\teventType: event?.eventType || \"event\",\r\n\t\t\t\tmessage: event?.message || \"\",\r\n\t\t\t\ttimestamp: event?.timestamp || null,\r\n\t\t\t\ttimestampMs: event?.timestampMs || null,\r\n\t\t\t\telapsedMs: typeof event?.elapsedMs === \"number\" ? event.elapsedMs : null,\r\n\t\t\t\tdeltaMs: typeof event?.deltaMs === \"number\" ? event.deltaMs : null,\r\n\t\t\t\tdurationMs: primaryDurationMs,\r\n\t\t\t\tphaseTimings,\r\n\t\t\t\texportMetrics: event?.exportMetrics\r\n\t\t\t\t\t|| (event?.eventType === \"transfer_created\" ? detailedSummary?.export || null : null),\r\n\t\t\t\tcolor: isFailure ? \"red\" : isSuccess ? \"green\" : \"blue\",\r\n\t\t\t};\r\n\t\t}),\r\n\t\t[selectedDetails, detailedSummary]\r\n\t);\r\n\tconst payloadRows = useMemo(() => buildMetricRows(detailedSummary?.payload), [detailedSummary]);\r\n\tconst exportRows = useMemo(() => buildMetricRows(detailedSummary?.export), [detailedSummary]);\r\n\tconst importRows = useMemo(() => buildMetricRows(detailedSummary?.import), [detailedSummary]);\r\n\r\n\tconst validation = detailedSummary?.validation || null;\r\n\tconst validationRows = useMemo(() => {\r\n\t\tif (!validation) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t\treturn [\r\n\t\t\t{ key: \"itemCountMatch\", metric: \"Item counts match\", value: validation.itemCountMatch ? \"Yes\" : \"No\" },\r\n\t\t\t{ key: \"fluidCountMatch\", metric: \"Fluid counts match\", value: validation.fluidCountMatch ? \"Yes\" : \"No\" },\r\n\t\t\t{ key: \"entityCount\", metric: \"Entity count\", value: formatNumeric(validation.entityCount, 0) },\r\n\t\t\t{ key: \"itemTypesExpected\", metric: \"Item types (expected)\", value: formatNumeric(validation.itemTypesExpected, 0) },\r\n\t\t\t{ key: \"itemTypesActual\", metric: \"Item types (actual)\", value: formatNumeric(validation.itemTypesActual, 0) },\r\n\t\t\t{ key: \"fluidTypesExpected\", metric: \"Fluid types (expected)\", value: formatNumeric(validation.fluidTypesExpected, 0) },\r\n\t\t\t{ key: \"fluidTypesActual\", metric: \"Fluid types (actual)\", value: formatNumeric(validation.fluidTypesActual, 0) },\r\n\t\t];\r\n\t}, [validation]);\r\n\r\n\tconst expectedItems = validation?.expectedItemCounts\r\n\t\t|| detailedSummary?.sourceVerification?.itemCounts\r\n\t\t|| {};\r\n\tconst actualItems = validation?.actualItemCounts || {};\r\n\tconst expectedFluids = validation?.expectedFluidCounts\r\n\t\t|| detailedSummary?.sourceVerification?.fluidCounts\r\n\t\t|| {};\r\n\tconst actualFluids = validation?.actualFluidCounts || {};\r\n\r\n\tconst itemRows = useMemo(() => buildExpectedActualRows(expectedItems, actualItems), [expectedItems, actualItems]);\r\n\tconst highTempThreshold = Number(validation?.fluidReconciliation?.highTempThreshold ?? 10000);\r\n\tconst fluidInventoryRows = useMemo(\r\n\t\t() => buildFluidInventoryRows(\r\n\t\t\texpectedFluids,\r\n\t\t\tactualFluids,\r\n\t\t\thighTempThreshold,\r\n\t\t\tvalidation?.fluidReconciliation?.highTempAggregates || {}\r\n\t\t),\r\n\t\t[expectedFluids, actualFluids, highTempThreshold, validation]\r\n\t);\r\n\r\n\tconst itemExpectedTotal = validation?.totalExpectedItems ?? sumValues(expectedItems);\r\n\tconst itemActualTotal = validation?.totalActualItems ?? sumValues(actualItems);\r\n\tconst fluidExpectedTotal = validation?.totalExpectedFluids ?? sumValues(expectedFluids);\r\n\tconst fluidActualTotal = validation?.totalActualFluids ?? sumValues(actualFluids);\r\n\r\n\tconst entityRows = useMemo(\r\n\t\t() => Object.entries(validation?.entityTypeBreakdown || {})\r\n\t\t\t.map(([type, count]) => ({\r\n\t\t\t\tkey: type,\r\n\t\t\t\tentityType: type,\r\n\t\t\t\tcount: Number(count) || 0,\r\n\t\t\t}))\r\n\t\t\t.sort((a, b) => b.count - a.count),\r\n\t\t[validation]\r\n\t);\r\n\r\n\tconst fluidReconciliationRows = useMemo(() => {\r\n\t\tconst recon = validation?.fluidReconciliation;\r\n\t\tif (!recon) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t\treturn [\r\n\t\t\t{ key: \"rawFluidDelta\", metric: \"Raw fluid delta\", value: formatSigned(recon.rawFluidDelta, 1) },\r\n\t\t\t{ key: \"reconciledFluidLoss\", metric: \"Reconciled fluid loss\", value: formatNumeric(recon.reconciledFluidLoss, 1) },\r\n\t\t\t{ key: \"lowTempLoss\", metric: \"Low-temp loss\", value: formatNumeric(recon.lowTempLoss, 1) },\r\n\t\t\t{ key: \"highTempReconciledLoss\", metric: \"High-temp reconciled loss\", value: formatNumeric(recon.highTempReconciledLoss, 1) },\r\n\t\t\t{ key: \"fluidPreservedPct\", metric: \"Fluid preserved\", value: `${formatNumeric(recon.fluidPreservedPct, 1)}%` },\r\n\t\t\t{ key: \"highTempThreshold\", metric: \"High-temp threshold\", value: formatNumeric(recon.highTempThreshold, 0) },\r\n\t\t];\r\n\t}, [validation]);\r\n\r\n\tconst fluidColumns = [\r\n\t\t{\r\n\t\t\ttitle: \"Fluid / Bucket\",\r\n\t\t\tkey: \"fluid\",\r\n\t\t\twidth: \"32%\",\r\n\t\t\trender: (_, row) => (\r\n\t\t\t\trow.isGroup\r\n\t\t\t\t\t? <Text code>{row.name}</Text>\r\n\t\t\t\t\t: (\r\n\t\t\t\t\t\t<Tooltip title={row.bucketKey}>\r\n\t\t\t\t\t\t\t<Text type=\"secondary\">{row.tempBucket === \"-\" ? row.bucketKey : `@${row.tempBucket}`}</Text>\r\n\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t)\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Category\",\r\n\t\t\tdataIndex: \"category\",\r\n\t\t\tkey: \"category\",\r\n\t\t\trender: value => (\r\n\t\t\t\t<Tag color={value === \"High-temp\" ? \"gold\" : \"default\"}>\r\n\t\t\t\t\t{value}\r\n\t\t\t\t</Tag>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Expected\",\r\n\t\t\tdataIndex: \"expected\",\r\n\t\t\tkey: \"expected\",\r\n\t\t\trender: value => formatNumeric(value, 1),\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Actual\",\r\n\t\t\tdataIndex: \"actual\",\r\n\t\t\tkey: \"actual\",\r\n\t\t\trender: value => formatNumeric(value, 1),\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Î”\",\r\n\t\t\tdataIndex: \"delta\",\r\n\t\t\tkey: \"delta\",\r\n\t\t\trender: (delta, row) => {\r\n\t\t\t\tif (!row.isGroup && row.category === \"High-temp\" && row.reconciled && Math.abs(delta) > 0.0001) {\r\n\t\t\t\t\treturn <Text type=\"warning\">{formatSigned(delta, 1)}</Text>;\r\n\t\t\t\t}\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<Text type={delta === 0 ? undefined : delta > 0 ? \"success\" : \"danger\"}>\r\n\t\t\t\t\t\t{formatSigned(delta, 1)}\r\n\t\t\t\t\t</Text>\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Preserved\",\r\n\t\t\tdataIndex: \"preservedPct\",\r\n\t\t\tkey: \"preservedPct\",\r\n\t\t\trender: value => (value === null ? \"-\" : `${formatNumeric(value, 1)}%`),\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Status\",\r\n\t\t\tdataIndex: \"status\",\r\n\t\t\tkey: \"status\",\r\n\t\t\trender: (status, row) => {\r\n\t\t\t\tif (status === \"Reconciled aggregate\") {\r\n\t\t\t\t\treturn <Tag color=\"green\">Reconciled aggregate</Tag>;\r\n\t\t\t\t}\r\n\t\t\t\tif (status === \"Bucket drift (reconciled)\") {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<Tooltip title=\"High-temp bucket drift is expected from temperature merging/averaging.\">\r\n\t\t\t\t\t\t\t<Tag color=\"gold\">Bucket drift (reconciled)</Tag>\r\n\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tif (status === \"Mismatch\") {\r\n\t\t\t\t\treturn <Tag color={row.category === \"High-temp\" ? \"warning\" : \"error\"}>Mismatch</Tag>;\r\n\t\t\t\t}\r\n\t\t\t\treturn <Tag color=\"default\">Match</Tag>;\r\n\t\t\t},\r\n\t\t},\r\n\t];\r\n\r\n\tconst selectedStatus = detailedSummary?.status || selectedDetails?.transferInfo?.status || \"unknown\";\r\n\tconst selectedResult = detailedSummary?.result || \"IN_PROGRESS\";\r\n\tconst summaryAlertType = selectedResult === \"SUCCESS\"\r\n\t\t? \"success\"\r\n\t\t: selectedResult === \"FAILED\" ? \"error\" : \"info\";\r\n\tconst detailLoaded = Boolean(selectedDetails && detailedSummary);\r\n\tconst hasValidation = Boolean(validation);\r\n\r\n\treturn (\r\n\t\t<div className=\"surface-export-log-body\">\r\n\t\t\t<Card title=\"Recent Transfer Logs\">\r\n\t\t\t\t<Table\r\n\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\tcolumns={columns}\r\n\t\t\t\t\tdataSource={state.transferSummaries}\r\n\t\t\t\t\trowKey={row => row.transferId}\r\n\t\t\t\t\tpagination={{ pageSize: 10 }}\r\n\t\t\t\t\trowClassName={row => row.transferId === selectedTransferId ? \"surface-export-log-row-selected\" : \"surface-export-log-row\"}\r\n\t\t\t\t\tonRow={row => ({\r\n\t\t\t\t\t\tonClick: async () => {\r\n\t\t\t\t\t\t\tsetSelectedTransferId(row.transferId);\r\n\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\tawait plugin.loadTransactionLog(row.transferId);\r\n\t\t\t\t\t\t\t} catch (err) {\r\n\t\t\t\t\t\t\t\tantMessage.error(err.message || \"Failed to load transaction log\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t})}\r\n\t\t\t\t/>\r\n\t\t\t</Card>\r\n\r\n\t\t\t{!selectedTransferId ? (\r\n\t\t\t\t<Card title=\"Transfer Details\">\r\n\t\t\t\t\t<Empty description=\"Select a transfer row to view details\" />\r\n\t\t\t\t</Card>\r\n\t\t\t) : null}\r\n\r\n\t\t\t{selectedTransferId && !selectedDetails ? (\r\n\t\t\t\t<Card title=\"Transfer Details\">\r\n\t\t\t\t\t<Spin />\r\n\t\t\t\t</Card>\r\n\t\t\t) : null}\r\n\r\n\t\t\t{detailLoaded ? (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<Card title=\"Transfer Summary\">\r\n\t\t\t\t\t\t<Alert\r\n\t\t\t\t\t\t\ttype={summaryAlertType}\r\n\t\t\t\t\t\t\tshowIcon\r\n\t\t\t\t\t\t\tmessage={`${selectedResult}: ${detailedSummary.platform?.name || selectedTransferId}`}\r\n\t\t\t\t\t\t\tdescription={`Duration: ${detailedSummary.totalDurationStr} | Status: ${selectedStatus}`}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Space direction=\"vertical\" style={{ width: \"100%\", marginTop: 12 }}>\r\n\t\t\t\t\t\t\t{detailedSummary.error ? (\r\n\t\t\t\t\t\t\t\t<Alert\r\n\t\t\t\t\t\t\t\t\ttype=\"error\"\r\n\t\t\t\t\t\t\t\t\tshowIcon\r\n\t\t\t\t\t\t\t\t\tmessage=\"Transfer error\"\r\n\t\t\t\t\t\t\t\t\tdescription={detailedSummary.error}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t) : null}\r\n\t\t\t\t\t\t\t<Table\r\n\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\tpagination={false}\r\n\t\t\t\t\t\t\t\tcolumns={metricColumns}\r\n\t\t\t\t\t\t\t\tdataSource={[\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tkey: \"platform\",\r\n\t\t\t\t\t\t\t\t\t\tmetric: \"Platform\",\r\n\t\t\t\t\t\t\t\t\t\tvalue: detailedSummary.platform?.name || \"-\",\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tkey: \"source\",\r\n\t\t\t\t\t\t\t\t\t\tmetric: \"Source\",\r\n\t\t\t\t\t\t\t\t\t\tvalue: detailedSummary.platform?.source?.instanceName\r\n\t\t\t\t\t\t\t\t\t\t\t|| detailedSummary.platform?.source?.instanceId\r\n\t\t\t\t\t\t\t\t\t\t\t|| \"-\",\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tkey: \"destination\",\r\n\t\t\t\t\t\t\t\t\t\tmetric: \"Destination\",\r\n\t\t\t\t\t\t\t\t\t\tvalue: detailedSummary.platform?.destination?.instanceName\r\n\t\t\t\t\t\t\t\t\t\t\t|| detailedSummary.platform?.destination?.instanceId\r\n\t\t\t\t\t\t\t\t\t\t\t|| \"-\",\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</Space>\r\n\t\t\t\t\t</Card>\r\n\r\n\r\n\t\t\t\t\t<Card title=\"Payload Metrics\">\r\n\t\t\t\t\t\t{payloadRows.length ? (\r\n\t\t\t\t\t\t\t<Table size=\"small\" pagination={false} columns={metricColumns} dataSource={payloadRows} />\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<Empty description=\"No payload metrics available\" />\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</Card>\r\n\t\t\t\t\t<Card title=\"Export Metrics\">\r\n\t\t\t\t\t\t{exportRows.length ? (\r\n\t\t\t\t\t\t\t<Table size=\"small\" pagination={false} columns={metricColumns} dataSource={exportRows} />\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<Empty description=\"No export timing metrics available\" />\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</Card>\r\n\r\n\t\t\t\t\t<Card title=\"Import Processing Metrics\">\r\n\t\t\t\t\t\t{importRows.length ? (\r\n\t\t\t\t\t\t\t<Table size=\"small\" pagination={false} columns={metricColumns} dataSource={importRows} />\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<Empty description=\"No import metrics available\" />\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</Card>\r\n\r\n\t\t\t\t\t<Card title=\"Validation Overview\">\r\n\t\t\t\t\t\t{hasValidation ? (\r\n\t\t\t\t\t\t\t<Space direction=\"vertical\" style={{ width: \"100%\" }}>\r\n\t\t\t\t\t\t\t\t<Table size=\"small\" pagination={false} columns={metricColumns} dataSource={validationRows} />\r\n\t\t\t\t\t\t\t\t{validation?.mismatchDetails ? (\r\n\t\t\t\t\t\t\t\t\t<Alert\r\n\t\t\t\t\t\t\t\t\t\ttype=\"error\"\r\n\t\t\t\t\t\t\t\t\t\tshowIcon\r\n\t\t\t\t\t\t\t\t\t\tmessage=\"Validation mismatch details\"\r\n\t\t\t\t\t\t\t\t\t\tdescription={validation.mismatchDetails}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t) : null}\r\n\t\t\t\t\t\t\t\t<Table\r\n\t\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\t\tpagination={false}\r\n\t\t\t\t\t\t\t\t\tcolumns={validationCategoryColumns}\r\n\t\t\t\t\t\t\t\t\tdataSource={validationCategoryRows}\r\n\t\t\t\t\t\t\t\t\texpandable={{\r\n\t\t\t\t\t\t\t\t\t\texpandedRowRender: row => {\r\n\t\t\t\t\t\t\t\t\t\t\tif (row.key === \"validation:entities\") {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn entityRows.length ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Table\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tpagination={{ pageSize: 10 }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolumns={[\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: \"Entity Type\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdataIndex: \"entityType\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey: \"entityType\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trender: value => <Text code>{value}</Text>,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: \"Count\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdataIndex: \"count\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey: \"count\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trender: value => formatNumeric(value, 0),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdataSource={entityRows}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\trowKey={entry => entry.key}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Empty description=\"No entity details available\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tif (row.key === \"validation:items\") {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn itemRows.length ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Table\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tpagination={{ pageSize: 10 }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolumns={comparisonColumns}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdataSource={itemRows}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\trowKey={entry => entry.key}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Empty description=\"No item details available\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tif (row.key === \"validation:fluids\") {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Space direction=\"vertical\" style={{ width: \"100%\" }} size=\"middle\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{fluidInventoryRows.length ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Table\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpagination={{ pageSize: 10 }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolumns={fluidColumns}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdataSource={fluidInventoryRows}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trowKey={entry => entry.key}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Empty description=\"No fluid details available\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{fluidReconciliationRows.length ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Table\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpagination={false}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolumns={metricColumns}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdataSource={fluidReconciliationRows}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trowKey={entry => entry.key}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : null}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Space>\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\trowExpandable: row => [ \"validation:entities\", \"validation:items\", \"validation:fluids\" ].includes(row.key),\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\trowKey={row => row.key}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Space>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<Empty description=\"No validation data available yet\" />\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</Card>\r\n\r\n\t\t\t\t\t<Card\r\n\t\t\t\t\t\ttitle={(\r\n\t\t\t\t\t\t\t<Space size=\"small\">\r\n\t\t\t\t\t\t\t\t<span>Transfer Flow (Timeline + Phases)</span>\r\n\t\t\t\t\t\t\t\t<Tooltip title=\"Chronological events with phase and import timing details in ms.\">\r\n\t\t\t\t\t\t\t\t\t<InfoCircleOutlined />\r\n\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t</Space>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{flowRows.length ? (\r\n\t\t\t\t\t\t\t<Table\r\n\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\tpagination={{ pageSize: 20 }}\r\n\t\t\t\t\t\t\t\tcolumns={flowColumns}\r\n\t\t\t\t\t\t\t\tdataSource={flowRows}\r\n\t\t\t\t\t\t\t\trowKey={row => row.key}\r\n\t\t\t\t\t\t\t\texpandable={{\r\n\t\t\t\t\t\t\t\t\texpandedRowRender: row => (\r\n\t\t\t\t\t\t\t\t\t\t<Space direction=\"vertical\" style={{ width: \"100%\" }}>\r\n\t\t\t\t\t\t\t\t\t\t\t{row.phaseTimings?.length ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Table\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpagination={false}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolumns={[\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{ title: \"Phase\", dataIndex: \"phase\", key: \"phase\" },\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: \"Source\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdataIndex: \"source\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey: \"source\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trender: value => <Tag>{value}</Tag>,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: \"Duration\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdataIndex: \"durationMs\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey: \"durationMs\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trender: value => `${formatNumeric(value, 0)} ms`,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdataSource={row.phaseTimings}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\trowKey={entry => entry.key}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Empty description=\"No phase timing details on this step\" />\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t{row.exportMetrics ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Table\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpagination={false}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolumns={metricColumns}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdataSource={buildMetricRows(row.exportMetrics)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\trowKey={entry => entry.key}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t) : null}\r\n\t\t\t\t\t\t\t\t\t\t</Space>\r\n\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t\trowExpandable: row => Boolean(row.phaseTimings?.length || row.exportMetrics),\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<Empty description=\"No transfer flow events available\" />\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</Card>\r\n\t\t\t\t</>\r\n\t\t\t) : null}\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nfunction SurfaceExportPage() {\r\n\tconst control = useContext(ControlContext);\r\n\tconst plugin = useSurfaceExportPlugin(control);\r\n\tconst state = useSurfaceExportState(plugin);\r\n\tconst pluginVersion = state?.pluginVersion || null;\r\n\tconst tabItems = [\r\n\t\t{\r\n\t\t\tkey: \"manual\",\r\n\t\t\tlabel: \"Manual Transfer\",\r\n\t\t\tchildren: <ManualTransferTab plugin={plugin} state={state} />,\r\n\t\t},\r\n\t];\r\n\tif (state.canViewLogs !== false) {\r\n\t\ttabItems.push({\r\n\t\t\tkey: \"logs\",\r\n\t\t\tlabel: \"Transaction Logs\",\r\n\t\t\tchildren: <TransactionLogsTab plugin={plugin} state={state} />,\r\n\t\t});\r\n\t}\r\n\r\n\treturn (\r\n\t\t<PageLayout nav={[{ name: \"Surface Export\" }]}>\r\n\t\t\t<PageHeader title=\"Surface Export\" />\r\n\t\t\t{pluginVersion ? (\r\n\t\t\t\t<Text type=\"secondary\" style={{ fontSize: 12, display: \"block\", marginBottom: 12 }}>\r\n\t\t\t\t\tv{pluginVersion}\r\n\t\t\t\t</Text>\r\n\t\t\t) : null}\r\n\t\t\t<Tabs\r\n\t\t\t\tdefaultActiveKey=\"manual\"\r\n\t\t\t\titems={tabItems}\r\n\t\t\t/>\r\n\t\t</PageLayout>\r\n\t);\r\n}\r\n\r\nexport class WebPlugin extends BaseWebPlugin {\r\n\tconstructor(container, packageData, info, control, logger) {\r\n\t\tsuper(container, packageData, info, control, logger);\r\n\t\tthis.callbacks = [];\r\n\t\tthis.liveUpdatesEnabled = false;\r\n\t\tthis.state = {\r\n\t\t\ttree: null,\r\n\t\t\tloadingTree: false,\r\n\t\t\ttreeError: null,\r\n\t\t\ttransferSummaries: [],\r\n\t\t\tlogDetails: {},\r\n\t\t\tlastTreeRevision: 0,\r\n\t\t\tlastTransferRevision: 0,\r\n\t\t\tlastLogRevision: 0,\r\n\t\t\tcanViewLogs: true,\r\n\t\t\tpluginVersion: packageData?.version || null,\r\n\t\t};\r\n\t}\r\n\r\n\tasync init() {\r\n\t\tthis.pages = [\r\n\t\t\t{\r\n\t\t\t\tpath: \"/surface-export\",\r\n\t\t\t\tsidebarName: \"Surface Export\",\r\n\t\t\t\tpermission: PERMISSIONS.UI_VIEW,\r\n\t\t\t\tcontent: <SurfaceExportPage />,\r\n\t\t\t},\r\n\t\t];\r\n\r\n\t\tthis.control.handle(SurfaceExportTreeUpdateEvent, this.handleTreeUpdate.bind(this));\r\n\t\tthis.control.handle(SurfaceExportTransferUpdateEvent, this.handleTransferUpdate.bind(this));\r\n\t\tthis.control.handle(SurfaceExportLogUpdateEvent, this.handleLogUpdate.bind(this));\r\n\t}\r\n\r\n\tonControllerConnectionEvent(event) {\r\n\t\tif (event === \"connect\" || event === \"resume\") {\r\n\t\t\tthis.syncLiveState().catch(notifyErrorHandler(\"Failed to resubscribe Surface Export live updates\"));\r\n\t\t}\r\n\t}\r\n\r\n\tgetState() {\r\n\t\treturn this.state;\r\n\t}\r\n\r\n\tsetState(partial) {\r\n\t\tthis.state = { ...this.state, ...partial };\r\n\t\tfor (const callback of this.callbacks) {\r\n\t\t\tcallback();\r\n\t\t}\r\n\t}\r\n\r\n\tonUpdate(callback) {\r\n\t\tthis.callbacks.push(callback);\r\n\t\tthis.syncLiveState().catch(notifyErrorHandler(\"Failed to start Surface Export live updates\"));\r\n\t}\r\n\r\n\toffUpdate(callback) {\r\n\t\tconst index = this.callbacks.lastIndexOf(callback);\r\n\t\tif (index !== -1) {\r\n\t\t\tthis.callbacks.splice(index, 1);\r\n\t\t}\r\n\t\tthis.syncLiveState().catch(notifyErrorHandler(\"Failed to update Surface Export subscription\"));\r\n\t}\r\n\r\n\tasync syncLiveState() {\r\n\t\tconst shouldEnable = this.callbacks.length > 0;\r\n\t\tif (!this.control.connector.connected) {\r\n\t\t\tthis.liveUpdatesEnabled = shouldEnable;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst trySubscribe = logs => this.control.send(new SetSurfaceExportSubscriptionRequest({\r\n\t\t\ttree: shouldEnable,\r\n\t\t\ttransfers: shouldEnable,\r\n\t\t\tlogs,\r\n\t\t\ttransferId: null,\r\n\t\t}));\r\n\t\tlet logsEnabled = shouldEnable && this.state.canViewLogs !== false;\r\n\t\ttry {\r\n\t\t\tawait trySubscribe(logsEnabled);\r\n\t\t} catch (err) {\r\n\t\t\tif (logsEnabled && /permission denied/i.test(err?.message || \"\")) {\r\n\t\t\t\tlogsEnabled = false;\r\n\t\t\t\tthis.setState({ canViewLogs: false });\r\n\t\t\t\tawait trySubscribe(false);\r\n\t\t\t} else {\r\n\t\t\t\tthrow err;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.liveUpdatesEnabled = shouldEnable;\r\n\t\tif (shouldEnable) {\r\n\t\t\tawait this.refreshSnapshots();\r\n\t\t}\r\n\t}\r\n\r\n\tasync refreshSnapshots() {\r\n\t\tthis.setState({ loadingTree: true, treeError: null });\r\n\t\ttry {\r\n\t\t\tconst treeResponse = await this.control.send(new GetPlatformTreeRequest({ forceName: \"player\" }));\r\n\t\t\tlet transferSummaries = this.state.transferSummaries;\r\n\t\t\tif (this.state.canViewLogs !== false) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst logSummaries = await this.control.send(new ListTransactionLogsRequest({ limit: 100 }));\r\n\t\t\t\t\ttransferSummaries = Array.isArray(logSummaries)\r\n\t\t\t\t\t\t? [...logSummaries].sort((a, b) => (b.startedAt || 0) - (a.startedAt || 0))\r\n\t\t\t\t\t\t: [];\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\tif (/permission denied/i.test(err?.message || \"\")) {\r\n\t\t\t\t\t\tthis.setState({ canViewLogs: false });\r\n\t\t\t\t\t\ttransferSummaries = [];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrow err;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.setState({\r\n\t\t\t\ttree: {\r\n\t\t\t\t\tforceName: treeResponse.forceName,\r\n\t\t\t\t\thosts: treeResponse.hosts || [],\r\n\t\t\t\t\tunassignedInstances: treeResponse.unassignedInstances || [],\r\n\t\t\t\t\trevision: treeResponse.revision,\r\n\t\t\t\t\tgeneratedAt: treeResponse.generatedAt,\r\n\t\t\t\t},\r\n\t\t\t\ttransferSummaries,\r\n\t\t\t\tloadingTree: false,\r\n\t\t\t\ttreeError: null,\r\n\t\t\t});\r\n\t\t} catch (err) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tloadingTree: false,\r\n\t\t\t\ttreeError: err.message || \"Failed to refresh Surface Export state\",\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tasync startTransfer(payload) {\r\n\t\treturn this.control.send(new StartPlatformTransferRequest(payload));\r\n\t}\r\n\r\n\tasync loadTransactionLog(transferId) {\r\n\t\tconst response = await this.control.send(new GetTransactionLogRequest({ transferId }));\r\n\t\tif (!response.success) {\r\n\t\t\tthrow new Error(response.error || \"Failed to load transaction log\");\r\n\t\t}\r\n\r\n\t\tconst existing = this.state.logDetails[transferId] || {};\r\n\t\tconst transferInfo = response.transferInfo || existing.transferInfo || null;\r\n\t\tconst events = Array.isArray(response.events) ? response.events : existing.events || [];\r\n\t\tconst detail = {\r\n\t\t\ttransferInfo,\r\n\t\t\tsummary: response.summary || existing.summary || null,\r\n\t\t\tevents,\r\n\t\t};\r\n\r\n\t\tconst transferSummary = summaryFromTransferInfo(transferInfo, events.length ? events[events.length - 1].timestampMs : null);\r\n\t\tif (transferSummary) {\r\n\t\t\ttransferSummary.transferId = transferId;\r\n\t\t}\r\n\r\n\t\tthis.setState({\r\n\t\t\tlogDetails: {\r\n\t\t\t\t...this.state.logDetails,\r\n\t\t\t\t[transferId]: detail,\r\n\t\t\t},\r\n\t\t\ttransferSummaries: transferSummary\r\n\t\t\t\t? mergeTransferSummary(this.state.transferSummaries, transferSummary)\r\n\t\t\t\t: this.state.transferSummaries,\r\n\t\t});\r\n\t}\r\n\r\n\tasync handleTreeUpdate(event) {\r\n\t\tif (event.revision <= this.state.lastTreeRevision) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.setState({\r\n\t\t\ttree: {\r\n\t\t\t\tforceName: event.forceName,\r\n\t\t\t\thosts: event.tree?.hosts || [],\r\n\t\t\t\tunassignedInstances: event.tree?.unassignedInstances || [],\r\n\t\t\t\trevision: event.revision,\r\n\t\t\t\tgeneratedAt: event.generatedAt,\r\n\t\t\t},\r\n\t\t\tloadingTree: false,\r\n\t\t\ttreeError: null,\r\n\t\t\tlastTreeRevision: event.revision,\r\n\t\t});\r\n\t}\r\n\r\n\tasync handleTransferUpdate(event) {\r\n\t\tif (event.revision <= this.state.lastTransferRevision) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.setState({\r\n\t\t\ttransferSummaries: mergeTransferSummary(this.state.transferSummaries, event.transfer),\r\n\t\t\tlastTransferRevision: event.revision,\r\n\t\t});\r\n\t}\r\n\r\n\tasync handleLogUpdate(event) {\r\n\t\tif (event.revision <= this.state.lastLogRevision) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst existing = this.state.logDetails[event.transferId] || { events: [] };\r\n\t\tconst events = [...existing.events];\r\n\t\tconst incoming = event.event || {};\r\n\t\tconst lastEvent = events.length ? events[events.length - 1] : null;\r\n\t\tconst isDuplicate = lastEvent\r\n\t\t\t&& lastEvent.timestampMs === incoming.timestampMs\r\n\t\t\t&& lastEvent.eventType === incoming.eventType\r\n\t\t\t&& lastEvent.message === incoming.message;\r\n\t\tif (!isDuplicate) {\r\n\t\t\tevents.push(incoming);\r\n\t\t}\r\n\r\n\t\tconst detail = {\r\n\t\t\ttransferInfo: event.transferInfo || existing.transferInfo || null,\r\n\t\t\tsummary: event.summary || existing.summary || null,\r\n\t\t\tevents,\r\n\t\t};\r\n\r\n\t\tlet transferSummary = null;\r\n\t\tif (event.transferInfo) {\r\n\t\t\ttransferSummary = summaryFromTransferInfo(event.transferInfo, incoming.timestampMs || null);\r\n\t\t\ttransferSummary.transferId = event.transferId;\r\n\t\t}\r\n\r\n\t\tthis.setState({\r\n\t\t\tlogDetails: {\r\n\t\t\t\t...this.state.logDetails,\r\n\t\t\t\t[event.transferId]: detail,\r\n\t\t\t},\r\n\t\t\ttransferSummaries: transferSummary\r\n\t\t\t\t? mergeTransferSummary(this.state.transferSummaries, transferSummary)\r\n\t\t\t\t: this.state.transferSummaries,\r\n\t\t\tlastLogRevision: event.revision,\r\n\t\t});\r\n\t}\r\n}\r\n"],"names":["___CSS_LOADER_EXPORT___","push","module","id","options","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","locals","PERMISSIONS","GetPlatformTreeRequest","ListTransactionLogsRequest","GetTransactionLogRequest","StartPlatformTransferRequest","SetSurfaceExportSubscriptionRequest","SurfaceExportTreeUpdateEvent","SurfaceExportTransferUpdateEvent","SurfaceExportLogUpdateEvent","messageDefs","Text","Typography","statusColor","status","summaryFromTransferInfo","transferInfo","lastEventAt","transferId","platformName","sourceInstanceId","sourceInstanceName","targetInstanceId","targetInstanceName","startedAt","Date","now","completedAt","failedAt","error","mergeTransferSummary","existing","incoming","byId","Map","map","summary","set","get","Array","from","values","sort","a","b","ManualTransferTab","plugin","state","selectedPlatformKey","setSelectedPlatformKey","useState","selectedTargetInstance","setSelectedTargetInstance","isSubmitting","setIsSubmitting","tree","loadingTree","treeError","latestCompletedByPlatform","useMemo","completed","transferSummaries","has","platformLookup","lookup","addInstancePlatforms","instance","platform","platforms","key","instanceId","platformIndex","instanceName","forceName","host","hosts","instances","unassignedInstances","instanceListData","rows","localeCompare","hostName","hostConnected","connected","instanceConnected","instancePlatformError","platformError","length","size","platformTargets","entries","hasTarget","some","row","filter","selectedSource","destinationOptions","instanceNodes","label","value","submitTransfer","response","startTransfer","sourcePlatformIndex","Number","success","errorDetails","console","info","antMessage","err","message","instanceColumns","title","dataIndex","width","render","Space","Tag","color","_","transferStatus","hasSpaceHub","entityExpectedTotal","validation","entityCount","entityRows","reduce","sum","count","entityActualTotal","category","expected","actual","delta","preservedPct","Math","abs","detailCount","itemExpectedTotal","itemActualTotal","itemCountMatch","itemRows","fluidExpectedTotal","fluidActualTotal","fluidCountMatch","fluidInventoryRows","div","className","Card","Spin","Alert","type","showIcon","Empty","description","Table","columns","dataSource","rowKey","pagination","pageSize","rowClassName","onRow","onClick","warning","direction","style","Select","placeholder","onChange","disabled","Button","loading","humanizeMetricKey","String","replace","trim","text","toUpperCase","formatNumeric","maxFractionDigits","isNaN","toLocaleString","undefined","maximumFractionDigits","formatSigned","sign","sumValues","Object","total","numeric","isFinite","buildMetricRows","data","formattedValue","lowered","toLowerCase","endsWith","isInteger","metric","findLatestEvent","events","predicate","index","TransactionLogsTab","selectedTransferId","setSelectedTransferId","selectedDetails","logDetails","detailedSummary","durationMs","transferCreatedEvent","validationEvent","completionEvent","latestEvent","result","finishedAt","totalDurationMs","sourceVerification","detail","isArray","event","eventType","includes","timestampMs","max","itemCounts","expectedItemCounts","fluidCounts","expectedFluidCounts","totalDurationStr","toFixed","round","phases","name","source","destination","export","exportMetrics","payload","payloadMetrics","import","importMetrics","code","metricColumns","comparisonColumns","flowRows","phaseTimings","transmissionMs","phase","validationMs","phaseName","phaseDurationMs","metricKey","primaryDurationMs","find","isFailure","isSuccess","timestamp","elapsedMs","deltaMs","payloadRows","exportRows","importRows","validationRows","itemTypesExpected","itemTypesActual","fluidTypesExpected","fluidTypesActual","expectedItems","actualItems","actualItemCounts","expectedFluids","actualFluids","actualFluidCounts","buildExpectedActualRows","expectedMap","actualMap","keys","Set","expectedValue","actualValue","highTempThreshold","fluidReconciliation","buildFluidInventoryRows","highTempAggregates","aggregates","threshold","groups","fluidKey","parsed","parseFluidTemperatureKey","match","baseName","temperatureC","rawKey","isHighTemp","hasHighTempBucket","children","group","bucketKey","tempBucket","isGroup","reconciled","aggregate","reconciledHighTemp","Boolean","child","absDelta","totalExpectedItems","totalActualItems","totalExpectedFluids","totalActualFluids","entityTypeBreakdown","entityType","fluidReconciliationRows","recon","rawFluidDelta","reconciledFluidLoss","lowTempLoss","highTempReconciledLoss","fluidPreservedPct","fluidColumns","Tooltip","selectedStatus","selectedResult","detailLoaded","hasValidation","loadTransactionLog","marginTop","mismatchDetails","validationCategoryColumns","validationCategoryRows","expandable","expandedRowRender","entry","rowExpandable","span","InfoCircleOutlined","flowColumns","SurfaceExportPage","control","useContext","ControlContext","plugins","useSurfaceExportState","setState","getState","useEffect","onUpdate","offUpdate","pluginVersion","tabItems","canViewLogs","PageLayout","nav","PageHeader","fontSize","display","marginBottom","Tabs","defaultActiveKey","items","WebPlugin","BaseWebPlugin","container","packageData","logger","callbacks","liveUpdatesEnabled","lastTreeRevision","lastTransferRevision","lastLogRevision","version","init","pages","path","sidebarName","permission","UI_VIEW","content","handle","handleTreeUpdate","bind","handleTransferUpdate","handleLogUpdate","onControllerConnectionEvent","syncLiveState","catch","notifyErrorHandler","partial","callback","lastIndexOf","splice","shouldEnable","connector","trySubscribe","logs","send","transfers","logsEnabled","test","refreshSnapshots","treeResponse","logSummaries","limit","revision","generatedAt","transferSummary","transfer","lastEvent"],"sourceRoot":""}